from pyspark import SparkContext
from pyspark.sql import SQLContext
from pyspark.sql.functions import lit
import numpy as np
import features_m as fb
import csv

all_drivers = ['1.json', '10.json', '100.json', '1000.json', '1001.json', '1002.json', '1003.json', '1004.json', '1005.json', '1006.json', '1007.json', '1008.json', '1009.json', '101.json', '1010.json', '1011.json', '1012.json', '1013.json', '1015.json', '1016.json', '1017.json', '1018.json', '102.json', '1020.json', '1021.json', '1022.json', '1023.json', '1024.json', '1025.json', '1026.json', '1027.json', '1029.json', '103.json', '1030.json', '1031.json', '1032.json', '1033.json', '1035.json', '1036.json', '1037.json', '1038.json', '104.json', '1040.json', '1041.json', '1042.json', '1043.json', '1044.json', '1045.json', '1046.json', '1047.json', '1048.json', '1049.json', '105.json', '1050.json', '1051.json', '1052.json', '1053.json', '1054.json', '1055.json', '1056.json', '1057.json', '1058.json', '1059.json', '106.json', '1060.json', '1061.json', '1062.json', '1063.json', '1064.json', '1065.json', '1066.json', '1067.json', '1068.json', '1069.json', '107.json', '1070.json', '1071.json', '1072.json', '1073.json', '1074.json', '1076.json', '1077.json', '1078.json', '1079.json', '108.json', '1080.json', '1081.json', '1082.json', '1083.json', '1084.json', '1085.json', '1086.json', '1087.json', '1088.json', '1089.json', '109.json', '1090.json', '1091.json', '1092.json', '1093.json', '1094.json', '1095.json', '1096.json', '1097.json', '1098.json', '1099.json', '11.json', '110.json', '1100.json', '1101.json', '1102.json', '1103.json', '1104.json', '1105.json', '1106.json', '1107.json', '1108.json', '1109.json', '111.json', '1110.json', '1111.json', '1113.json', '1114.json', '1115.json', '1117.json', '1118.json', '1119.json', '112.json', '1120.json', '1121.json', '1122.json', '1124.json', '1125.json', '1126.json', '1127.json', '1128.json', '1129.json', '113.json', '1130.json', '1131.json', '1132.json', '1133.json', '1135.json', '1137.json', '1138.json', '1139.json', '114.json', '1140.json', '1141.json', '1142.json', '1143.json', '1144.json', '1145.json', '1146.json', '1147.json', '1148.json', '1149.json', '115.json', '1150.json', '1151.json', '1152.json', '1153.json', '1154.json', '1155.json', '1156.json', '1157.json', '1158.json', '1159.json', '116.json', '1160.json', '1161.json', '1162.json', '1163.json', '1164.json', '1165.json', '1166.json', '1167.json', '1169.json', '117.json', '1170.json', '1171.json', '1172.json', '1173.json', '1174.json', '1175.json', '1176.json', '1177.json', '1178.json', '1179.json', '118.json', '1180.json', '1181.json', '1183.json', '1184.json', '1185.json', '1186.json', '1187.json', '1188.json', '119.json', '1190.json', '1191.json', '1192.json', '1193.json', '1194.json', '1195.json', '1196.json', '1197.json', '1198.json', '1199.json', '12.json', '120.json', '1200.json', '1201.json', '1202.json', '1203.json', '1204.json', '1205.json', '1206.json', '1207.json', '1208.json', '1209.json', '121.json', '1210.json', '1211.json', '1212.json', '1214.json', '1215.json', '1216.json', '1217.json', '1218.json', '1219.json', '122.json', '1220.json', '1221.json', '1222.json', '1223.json', '1224.json', '1225.json', '1226.json', '1227.json', '1229.json', '123.json', '1231.json', '1232.json', '1233.json', '1234.json', '1235.json', '1236.json', '1237.json', '1238.json', '1239.json', '1241.json', '1242.json', '1243.json', '1244.json', '1245.json', '1246.json', '1247.json', '125.json', '1250.json', '1251.json', '1252.json', '1253.json', '1255.json', '1256.json', '1257.json', '1258.json', '1259.json', '126.json', '1260.json', '1261.json', '1262.json', '1263.json', '1264.json', '1265.json', '1266.json', '1267.json', '1268.json', '127.json', '1270.json', '1271.json', '1272.json', '1273.json', '1274.json', '1275.json', '1276.json', '1277.json', '1278.json', '1279.json', '128.json', '1280.json', '1281.json', '1282.json', '1283.json', '1285.json', '1286.json', '1287.json', '1288.json', '129.json', '1290.json', '1292.json', '1293.json', '1294.json', '1295.json', '1296.json', '1297.json', '1298.json', '1299.json', '13.json', '130.json', '1300.json', '1301.json', '1302.json', '1303.json', '1304.json', '1305.json', '1306.json', '1307.json', '1308.json', '1309.json', '131.json', '1310.json', '1311.json', '1312.json', '1314.json', '1315.json', '1316.json', '1318.json', '1319.json', '132.json', '1321.json', '1323.json', '1324.json', '1325.json', '1326.json', '1327.json', '1328.json', '1329.json', '133.json', '1330.json', '1331.json', '1332.json', '1333.json', '1334.json', '1337.json', '1338.json', '1339.json', '134.json', '1340.json', '1341.json', '1342.json', '1343.json', '1344.json', '1345.json', '1346.json', '1347.json', '1348.json', '1349.json', '135.json', '1350.json', '1351.json', '1352.json', '1353.json', '1354.json', '1355.json', '1356.json', '1357.json', '1358.json', '1359.json', '136.json', '1360.json', '1361.json', '1362.json', '1363.json', '1364.json', '1365.json', '1366.json', '1367.json', '1368.json', '1369.json', '137.json', '1370.json', '1371.json', '1372.json', '1374.json', '1375.json', '1376.json', '1377.json', '1378.json', '1379.json', '138.json', '1380.json', '1381.json', '1382.json', '1383.json', '1384.json', '1385.json', '1386.json', '1387.json', '1388.json', '1389.json', '139.json', '1390.json', '1391.json', '1392.json', '1393.json', '1394.json', '1395.json', '1396.json', '1397.json', '1398.json', '1399.json', '14.json', '140.json', '1400.json', '1401.json', '1402.json', '1403.json', '1404.json', '1405.json', '1406.json', '1407.json', '1408.json', '141.json', '1410.json', '1411.json', '1412.json', '1413.json', '1414.json', '1415.json', '1416.json', '1417.json', '1418.json', '1419.json', '142.json', '1420.json', '1421.json', '1422.json', '1423.json', '1424.json', '1425.json', '1427.json', '1428.json', '1429.json', '143.json', '1432.json', '1433.json', '1434.json', '1435.json', '1436.json', '1437.json', '1438.json', '1439.json', '144.json', '1440.json', '1441.json', '1442.json', '1443.json', '1444.json', '1445.json', '1446.json', '1447.json', '1448.json', '145.json', '1450.json', '1453.json', '1454.json', '1456.json', '1457.json', '1458.json', '1460.json', '1461.json', '1462.json', '1463.json', '1464.json', '1465.json', '1466.json', '1467.json', '1468.json', '1469.json', '147.json', '1470.json', '1471.json', '1472.json', '1473.json', '1474.json', '1475.json', '1476.json', '1477.json', '1478.json', '1479.json', '148.json', '1480.json', '1481.json', '1482.json', '1483.json', '1484.json', '1485.json', '1486.json', '1487.json', '1488.json', '1489.json', '149.json', '1490.json', '1491.json', '1492.json', '1493.json', '1494.json', '1495.json', '1496.json', '1497.json', '1498.json', '1499.json', '15.json', '150.json', '1500.json', '1502.json', '1503.json', '1504.json', '1505.json', '1506.json', '1507.json', '1508.json', '1509.json', '151.json', '1510.json', '1511.json', '1512.json', '1513.json', '1514.json', '1515.json', '1516.json', '1517.json', '1519.json', '1520.json', '1521.json', '1522.json', '1524.json', '1525.json', '1526.json', '1529.json', '153.json', '1530.json', '1531.json', '1533.json', '1534.json', '1535.json', '1536.json', '1537.json', '1538.json', '1539.json', '154.json', '1540.json', '1541.json', '1542.json', '1543.json', '1544.json', '1545.json', '1546.json', '1547.json', '1548.json', '1549.json', '155.json', '1550.json', '1551.json', '1553.json', '1554.json', '1555.json', '1556.json', '1557.json', '1558.json', '1559.json', '156.json', '1560.json', '1561.json', '1562.json', '1563.json', '1564.json', '1565.json', '1567.json', '1568.json', '1569.json', '157.json', '1570.json', '1571.json', '1572.json', '1573.json', '1574.json', '1575.json', '1576.json', '1577.json', '1578.json', '1579.json', '158.json', '1580.json', '1581.json', '1582.json', '1583.json', '1584.json', '1586.json', '1587.json', '1588.json', '1589.json', '159.json', '1591.json', '1592.json', '1593.json', '1594.json', '1595.json', '1596.json', '1597.json', '1598.json', '16.json', '160.json', '1600.json', '1601.json', '1602.json', '1603.json', '1604.json', '1605.json', '1606.json', '1607.json', '1609.json', '161.json', '1610.json', '1611.json', '1612.json', '1613.json', '1614.json', '1615.json', '1616.json', '1619.json', '162.json', '1620.json', '1621.json', '1622.json', '1623.json', '1624.json', '1625.json', '1626.json', '1627.json', '1628.json', '1629.json', '163.json', '1630.json', '1631.json', '1632.json', '1633.json', '1634.json', '1635.json', '1636.json', '1637.json', '1638.json', '1639.json', '164.json', '1640.json', '1641.json', '1642.json', '1643.json', '1644.json', '1645.json', '1646.json', '1647.json', '1648.json', '1649.json', '1650.json', '1651.json', '1652.json', '1653.json', '1654.json', '1655.json', '1656.json', '1657.json', '1658.json', '1659.json', '166.json', '1660.json', '1662.json', '1663.json', '1664.json', '1665.json', '1666.json', '1667.json', '1668.json', '1669.json', '167.json', '1670.json', '1671.json', '1672.json', '1673.json', '1674.json', '1675.json', '1676.json', '1677.json', '1678.json', '1679.json', '168.json', '1680.json', '1681.json', '1682.json', '1684.json', '1685.json', '1687.json', '1688.json', '1689.json', '169.json', '1691.json', '1692.json', '1693.json', '1694.json', '1695.json', '1696.json', '1698.json', '17.json', '170.json', '1700.json', '1701.json', '1702.json', '1703.json', '1704.json', '1705.json', '1706.json', '1707.json', '1708.json', '1709.json', '171.json', '1710.json', '1711.json', '1712.json', '1713.json', '1714.json', '1715.json', '1716.json', '1718.json', '1719.json', '172.json', '1720.json', '1721.json', '1722.json', '1723.json', '1724.json', '1725.json', '1726.json', '1727.json', '1728.json', '1729.json', '173.json', '1730.json', '1731.json', '1732.json', '1733.json', '1734.json', '1735.json', '1739.json', '174.json', '1740.json', '1741.json', '1742.json', '1743.json', '1744.json', '1745.json', '1746.json', '1747.json', '1748.json', '1749.json', '175.json', '1750.json', '1751.json', '1752.json', '1753.json', '1754.json', '1755.json', '1756.json', '1757.json', '1758.json', '1759.json', '176.json', '1760.json', '1761.json', '1762.json', '1763.json', '1764.json', '1765.json', '1766.json', '1767.json', '1768.json', '1769.json', '177.json', '1770.json', '1771.json', '1773.json', '1774.json', '1775.json', '1776.json', '1777.json', '1778.json', '1779.json', '178.json', '1780.json', '1782.json', '1783.json', '1784.json', '1785.json', '1786.json', '1787.json', '1788.json', '1789.json', '179.json', '1790.json', '1791.json', '1792.json', '1793.json', '1794.json', '1795.json', '1796.json', '1797.json', '1798.json', '1799.json', '18.json', '180.json', '1800.json', '1801.json', '1802.json', '1803.json', '1804.json', '1805.json', '1806.json', '1807.json', '1808.json', '1809.json', '181.json', '1810.json', '1811.json', '1812.json', '1813.json', '1814.json', '1815.json', '1816.json', '1817.json', '1818.json', '1819.json', '182.json', '1820.json', '1821.json', '1822.json', '1823.json', '1824.json', '1825.json', '1826.json', '1827.json', '1828.json', '1829.json', '183.json', '1830.json', '1831.json', '1832.json', '1833.json', '1834.json', '1835.json', '1836.json', '1837.json', '1838.json', '1839.json', '184.json', '1840.json', '1841.json', '1842.json', '1843.json', '1844.json', '1845.json', '1846.json', '1847.json', '1848.json', '1849.json', '185.json', '1850.json', '1851.json', '1852.json', '1853.json', '1854.json', '1855.json', '1856.json', '1857.json', '1858.json', '1859.json', '186.json', '1860.json', '1861.json', '1862.json', '1863.json', '1864.json', '1865.json', '1866.json', '1867.json', '1868.json', '1869.json', '187.json', '1870.json', '1871.json', '1872.json', '1873.json', '1874.json', '1875.json', '1876.json', '1877.json', '1878.json', '1879.json', '188.json', '1880.json', '1881.json', '1882.json', '1883.json', '1884.json', '1885.json', '1886.json', '1887.json', '1888.json', '1889.json', '189.json', '1890.json', '1891.json', '1892.json', '1893.json', '1894.json', '1895.json', '1896.json', '1897.json', '1898.json', '1899.json', '19.json', '190.json', '1900.json', '1901.json', '1902.json', '1903.json', '1904.json', '1905.json', '1906.json', '1907.json', '1908.json', '1909.json', '191.json', '1910.json', '1911.json', '1912.json', '1913.json', '1914.json', '1915.json', '1917.json', '1918.json', '1919.json', '192.json', '1920.json', '1921.json', '1922.json', '1923.json', '1924.json', '1925.json', '1926.json', '1927.json', '1928.json', '1929.json', '193.json', '1930.json', '1931.json', '1932.json', '1933.json', '1934.json', '1935.json', '1936.json', '1937.json', '1938.json', '1939.json', '194.json', '1940.json', '1941.json', '1942.json', '1943.json', '1944.json', '1945.json', '1946.json', '1947.json', '1948.json', '1949.json', '195.json', '1950.json', '1951.json', '1952.json', '1953.json', '1954.json', '1955.json', '1956.json', '1958.json', '1959.json', '196.json', '1960.json', '1961.json', '1962.json', '1963.json', '1964.json', '1965.json', '1966.json', '1967.json', '1968.json', '1969.json', '197.json', '1970.json', '1971.json', '1972.json', '1973.json', '1974.json', '1975.json', '1976.json', '1977.json', '1978.json', '1979.json', '198.json', '1980.json', '1981.json', '1982.json', '1983.json', '1985.json', '1986.json', '1987.json', '1988.json', '199.json', '1990.json', '1991.json', '1992.json', '1993.json', '1994.json', '1995.json', '1996.json', '1997.json', '1998.json', '1999.json', '2.json', '20.json', '200.json', '2000.json', '2001.json', '2003.json', '2004.json', '2005.json', '2006.json', '2007.json', '2008.json', '2009.json', '201.json', '2010.json', '2011.json', '2012.json', '2013.json', '2014.json', '2015.json', '2016.json', '2017.json', '2018.json', '2019.json', '202.json', '2020.json', '2021.json', '2022.json', '2023.json', '2024.json', '2025.json', '2026.json', '2027.json', '2028.json', '2029.json', '203.json', '2030.json', '2031.json', '2032.json', '2033.json', '2034.json', '2035.json', '2036.json', '2037.json', '2038.json', '2039.json', '204.json', '2040.json', '2041.json', '2042.json', '2044.json', '2045.json', '2046.json', '2048.json', '2049.json', '205.json', '2050.json', '2051.json', '2052.json', '2053.json', '2054.json', '2055.json', '2056.json', '2057.json', '2058.json', '2059.json', '206.json', '2060.json', '2061.json', '2062.json', '2063.json', '2064.json', '2065.json', '2066.json', '2067.json', '2068.json', '2069.json', '207.json', '2070.json', '2071.json', '2072.json', '2073.json', '2074.json', '2075.json', '2077.json', '2078.json', '2079.json', '208.json', '2080.json', '2081.json', '2082.json', '2083.json', '2084.json', '2085.json', '2088.json', '2089.json', '209.json', '2090.json', '2091.json', '2092.json', '2093.json', '2094.json', '2095.json', '2096.json', '2097.json', '2098.json', '2099.json', '21.json', '210.json', '2100.json', '2101.json', '2102.json', '2103.json', '2104.json', '2105.json', '2106.json', '2107.json', '2108.json', '2109.json', '211.json', '2110.json', '2112.json', '2113.json', '2114.json', '2115.json', '2116.json', '2117.json', '2118.json', '2119.json', '212.json', '2120.json', '2121.json', '2122.json', '2123.json', '2124.json', '2125.json', '2126.json', '2127.json', '2128.json', '2129.json', '213.json', '2130.json', '2131.json', '2132.json', '2133.json', '2134.json', '2135.json', '2136.json', '2137.json', '2138.json', '2139.json', '214.json', '2140.json', '2141.json', '2142.json', '2143.json', '2144.json', '2145.json', '2146.json', '2147.json', '2148.json', '2149.json', '215.json', '2150.json', '2151.json', '2152.json', '2153.json', '2154.json', '2155.json', '2156.json', '2157.json', '2158.json', '2159.json', '216.json', '2160.json', '2161.json', '2162.json', '2163.json', '2164.json', '2166.json', '2167.json', '2168.json', '2169.json', '217.json', '2170.json', '2171.json', '2172.json', '2173.json', '2174.json', '2175.json', '2176.json', '2177.json', '2178.json', '2179.json', '218.json', '2180.json', '2181.json', '2182.json', '2183.json', '2184.json', '2185.json', '2186.json', '2187.json', '2188.json', '2189.json', '219.json', '2190.json', '2191.json', '2192.json', '2193.json', '2194.json', '2195.json', '2196.json', '2197.json', '2198.json', '2199.json', '22.json', '220.json', '2200.json', '2201.json', '2202.json', '2203.json', '2204.json', '2205.json', '2206.json', '2207.json', '2208.json', '2209.json', '221.json', '2210.json', '2211.json', '2212.json', '2213.json', '2214.json', '2215.json', '2216.json', '2217.json', '2218.json', '2219.json', '222.json', '2220.json', '2221.json', '2222.json', '2223.json', '2224.json', '2225.json', '2226.json', '2227.json', '2228.json', '2229.json', '223.json', '2230.json', '2231.json', '2232.json', '2233.json', '2234.json', '2235.json', '2236.json', '2238.json', '224.json', '2240.json', '2241.json', '2242.json', '2243.json', '2244.json', '2245.json', '2248.json', '2249.json', '225.json', '2250.json', '2251.json', '2252.json', '2253.json', '2254.json', '2255.json', '2256.json', '2257.json', '2258.json', '2259.json', '226.json', '2260.json', '2261.json', '2262.json', '2263.json', '2264.json', '2265.json', '2266.json', '2267.json', '2268.json', '2269.json', '227.json', '2270.json', '2271.json', '2272.json', '2273.json', '2274.json', '2275.json', '2276.json', '2277.json', '2278.json', '2279.json', '228.json', '2280.json', '2281.json', '2282.json', '2283.json', '2284.json', '2285.json', '2286.json', '2287.json', '2288.json', '2289.json', '229.json', '2290.json', '2291.json', '2292.json', '2293.json', '2294.json', '2295.json', '2296.json', '2297.json', '2298.json', '2299.json', '23.json', '230.json', '2300.json', '2301.json', '2303.json', '2304.json', '2305.json', '2306.json', '2307.json', '2308.json', '2309.json', '231.json', '2310.json', '2311.json', '2312.json', '2314.json', '2315.json', '2316.json', '2317.json', '2318.json', '2319.json', '232.json', '2320.json', '2321.json', '2322.json', '2323.json', '2324.json', '2325.json', '2326.json', '2327.json', '2328.json', '2329.json', '233.json', '2330.json', '2331.json', '2332.json', '2333.json', '2334.json', '2335.json', '2336.json', '2337.json', '2338.json', '2339.json', '234.json', '2341.json', '2342.json', '2343.json', '2345.json', '2346.json', '2347.json', '2348.json', '2349.json', '235.json', '2350.json', '2351.json', '2352.json', '2353.json', '2355.json', '2356.json', '2357.json', '2358.json', '2359.json', '236.json', '2360.json', '2361.json', '2362.json', '2363.json', '2364.json', '2365.json', '2366.json', '2367.json', '2368.json', '2369.json', '237.json', '2370.json', '2371.json', '2372.json', '2373.json', '2374.json', '2375.json', '2376.json', '2377.json', '2378.json', '2379.json', '238.json', '2381.json', '2382.json', '2383.json', '2384.json', '2385.json', '2386.json', '2387.json', '239.json', '2390.json', '2391.json', '2392.json', '2393.json', '2394.json', '2395.json', '2396.json', '2397.json', '2398.json', '2399.json', '24.json', '240.json', '2400.json', '2401.json', '2402.json', '2403.json', '2404.json', '2405.json', '2406.json', '2407.json', '2408.json', '2409.json', '241.json', '2410.json', '2411.json', '2412.json', '2413.json', '2414.json', '2415.json', '2416.json', '2417.json', '2418.json', '2419.json', '242.json', '2420.json', '2421.json', '2422.json', '2423.json', '2424.json', '2425.json', '2426.json', '2427.json', '2428.json', '2429.json', '243.json', '2430.json', '2431.json', '2432.json', '2433.json', '2434.json', '2435.json', '2436.json', '2437.json', '2438.json', '2439.json', '244.json', '2440.json', '2441.json', '2442.json', '2443.json', '2444.json', '2446.json', '2447.json', '2448.json', '2449.json', '245.json', '2450.json', '2451.json', '2452.json', '2453.json', '2454.json', '2455.json', '2456.json', '2457.json', '2458.json', '2459.json', '2460.json', '2461.json', '2462.json', '2463.json', '2464.json', '2465.json', '2466.json', '2467.json', '2468.json', '2469.json', '247.json', '2470.json', '2471.json', '2472.json', '2473.json', '2474.json', '2475.json', '2476.json', '2477.json', '2478.json', '2479.json', '248.json', '2480.json', '2481.json', '2482.json', '2483.json', '2484.json', '2486.json', '2487.json', '2488.json', '2489.json', '249.json', '2490.json', '2491.json', '2492.json', '2493.json', '2494.json', '2495.json', '2496.json', '2497.json', '2498.json', '2499.json', '25.json', '250.json', '2500.json', '2501.json', '2503.json', '2504.json', '2505.json', '2506.json', '2507.json', '2508.json', '2509.json', '251.json', '2511.json', '2512.json', '2513.json', '2514.json', '2515.json', '2516.json', '2517.json', '2518.json', '2519.json', '252.json', '2520.json', '2521.json', '2522.json', '2523.json', '2524.json', '2525.json', '2526.json', '2527.json', '2528.json', '2529.json', '253.json', '2530.json', '2531.json', '2532.json', '2533.json', '2534.json', '2535.json', '2536.json', '2537.json', '2538.json', '2539.json', '254.json', '2540.json', '2541.json', '2542.json', '2543.json', '2544.json', '2545.json', '2546.json', '2547.json', '2548.json', '2549.json', '255.json', '2550.json', '2552.json', '2553.json', '2554.json', '2555.json', '2556.json', '2557.json', '2558.json', '2559.json', '256.json', '2560.json', '2561.json', '2562.json', '2563.json', '2564.json', '2565.json', '2566.json', '2567.json', '2569.json', '257.json', '2570.json', '2571.json', '2572.json', '2573.json', '2574.json', '2575.json', '2576.json', '2577.json', '2578.json', '2579.json', '258.json', '2580.json', '2581.json', '2582.json', '2583.json', '2584.json', '2585.json', '2586.json', '2587.json', '2588.json', '2589.json', '259.json', '2590.json', '2591.json', '2592.json', '2594.json', '2595.json', '2596.json', '2597.json', '2598.json', '2599.json', '26.json', '260.json', '2600.json', '2601.json', '2602.json', '2603.json', '2604.json', '2605.json', '2607.json', '2608.json', '261.json', '2610.json', '2612.json', '2613.json', '2614.json', '2617.json', '2618.json', '2619.json', '262.json', '2620.json', '2621.json', '2622.json', '2623.json', '2624.json', '2625.json', '2626.json', '2627.json', '2628.json', '2629.json', '263.json', '2630.json', '2631.json', '2632.json', '2633.json', '2634.json', '2635.json', '2636.json', '2637.json', '2638.json', '2639.json', '264.json', '2640.json', '2641.json', '2642.json', '2643.json', '2644.json', '2645.json', '2646.json', '2647.json', '2648.json', '2649.json', '265.json', '2650.json', '2651.json', '2652.json', '2653.json', '2654.json', '2655.json', '2656.json', '2657.json', '2658.json', '2659.json', '266.json', '2660.json', '2661.json', '2662.json', '2663.json', '2664.json', '2665.json', '2666.json', '2667.json', '2668.json', '2669.json', '267.json', '2670.json', '2671.json', '2672.json', '2673.json', '2674.json', '2675.json', '2676.json', '2677.json', '2678.json', '2679.json', '268.json', '2680.json', '2681.json', '2682.json', '2683.json', '2684.json', '2685.json', '2686.json', '2687.json', '2688.json', '2689.json', '269.json', '2690.json', '2691.json', '2692.json', '2693.json', '2694.json', '2695.json', '2696.json', '2697.json', '2698.json', '2699.json', '27.json', '270.json', '2700.json', '2701.json', '2703.json', '2704.json', '2706.json', '2707.json', '2708.json', '2709.json', '271.json', '2710.json', '2711.json', '2712.json', '2713.json', '2714.json', '2716.json', '2717.json', '2718.json', '2719.json', '272.json', '2720.json', '2721.json', '2722.json', '2723.json', '2724.json', '2725.json', '2726.json', '2727.json', '2728.json', '2729.json', '273.json', '2730.json', '2731.json', '2732.json', '2733.json', '2735.json', '2736.json', '2737.json', '2738.json', '2739.json', '2740.json', '2741.json', '2742.json', '2743.json', '2744.json', '2745.json', '2746.json', '2747.json', '2748.json', '2749.json', '275.json', '2750.json', '2751.json', '2752.json', '2753.json', '2754.json', '2755.json', '2756.json', '2757.json', '2758.json', '2759.json', '2760.json', '2761.json', '2762.json', '2763.json', '2764.json', '2765.json', '2766.json', '2767.json', '2768.json', '2769.json', '277.json', '2770.json', '2771.json', '2772.json', '2773.json', '2774.json', '2775.json', '2776.json', '2777.json', '2778.json', '278.json', '2780.json', '2781.json', '2782.json', '2783.json', '2784.json', '2785.json', '2786.json', '2787.json', '2788.json', '2789.json', '279.json', '2791.json', '2792.json', '2793.json', '2794.json', '2795.json', '2796.json', '2797.json', '28.json', '2800.json', '2801.json', '2802.json', '2803.json', '2804.json', '2805.json', '2806.json', '2807.json', '2809.json', '2810.json', '2811.json', '2812.json', '2813.json', '2814.json', '2815.json', '2816.json', '2817.json', '2818.json', '2819.json', '282.json', '2820.json', '2821.json', '2822.json', '2823.json', '2824.json', '2825.json', '2826.json', '2827.json', '2828.json', '2829.json', '283.json', '2830.json', '2832.json', '2833.json', '2834.json', '2835.json', '2836.json', '2837.json', '2838.json', '2839.json', '284.json', '2840.json', '2841.json', '2842.json', '2843.json', '2844.json', '2845.json', '2846.json', '2847.json', '2848.json', '2849.json', '285.json', '2850.json', '2851.json', '2852.json', '2853.json', '2854.json', '2855.json', '2856.json', '2857.json', '2858.json', '2859.json', '286.json', '2860.json', '2861.json', '2862.json', '2863.json', '2864.json', '2865.json', '2866.json', '2867.json', '2868.json', '2869.json', '287.json', '2870.json', '2871.json', '2872.json', '2873.json', '2874.json', '2875.json', '2876.json', '2877.json', '2878.json', '2879.json', '288.json', '2881.json', '2882.json', '2883.json', '2884.json', '2885.json', '2886.json', '2887.json', '2888.json', '2889.json', '289.json', '2890.json', '2891.json', '2892.json', '2893.json', '2894.json', '2896.json', '2897.json', '2898.json', '2899.json', '290.json', '2900.json', '2901.json', '2902.json', '2903.json', '2904.json', '2905.json', '2906.json', '2908.json', '2909.json', '291.json', '2910.json', '2911.json', '2912.json', '2913.json', '2914.json', '2915.json', '2916.json', '2917.json', '2918.json', '2919.json', '292.json', '2920.json', '2921.json', '2922.json', '2923.json', '2924.json', '2925.json', '2926.json', '2927.json', '2928.json', '2929.json', '2930.json', '2931.json', '2932.json', '2933.json', '2934.json', '2935.json', '2936.json', '2937.json', '2938.json', '2939.json', '294.json', '2940.json', '2941.json', '2942.json', '2944.json', '2945.json', '2946.json', '2948.json', '2949.json', '295.json', '2950.json', '2951.json', '2952.json', '2953.json', '2954.json', '2955.json', '2956.json', '2957.json', '2958.json', '2959.json', '2960.json', '2961.json', '2962.json', '2963.json', '2964.json', '2965.json', '2966.json', '2967.json', '2968.json', '2969.json', '297.json', '2970.json', '2971.json', '2972.json', '2973.json', '2974.json', '2975.json', '2976.json', '2977.json', '2978.json', '2979.json', '298.json', '2980.json', '2981.json', '2982.json', '2983.json', '2984.json', '2985.json', '2987.json', '2989.json', '299.json', '2992.json', '2993.json', '2994.json', '2995.json', '2996.json', '2997.json', '2998.json', '2999.json', '3.json', '30.json', '300.json', '3000.json', '3001.json', '3002.json', '3003.json', '3004.json', '3005.json', '3006.json', '3007.json', '3008.json', '3009.json', '301.json', '3010.json', '3011.json', '3012.json', '3013.json', '3014.json', '3015.json', '3016.json', '3017.json', '3018.json', '3019.json', '302.json', '3020.json', '3021.json', '3022.json', '3023.json', '3024.json', '3025.json', '3026.json', '3027.json', '3028.json', '3029.json', '303.json', '3030.json', '3031.json', '3032.json', '3033.json', '3034.json', '3035.json', '3036.json', '3037.json', '3038.json', '3039.json', '304.json', '3040.json', '3041.json', '3042.json', '3043.json', '3044.json', '3045.json', '3046.json', '3047.json', '3048.json', '3049.json', '305.json', '3050.json', '3051.json', '3052.json', '3053.json', '3054.json', '3055.json', '3056.json', '3057.json', '3058.json', '306.json', '3061.json', '3063.json', '3064.json', '3066.json', '3067.json', '3068.json', '3069.json', '307.json', '3070.json', '3071.json', '3073.json', '3074.json', '3075.json', '3077.json', '3079.json', '308.json', '3080.json', '3082.json', '3083.json', '3084.json', '3085.json', '3086.json', '3087.json', '3088.json', '3089.json', '309.json', '3090.json', '3091.json', '3092.json', '3093.json', '3094.json', '3095.json', '3096.json', '3097.json', '3098.json', '3099.json', '31.json', '310.json', '3100.json', '3102.json', '3103.json', '3104.json', '3105.json', '3106.json', '3107.json', '3108.json', '3109.json', '311.json', '3110.json', '3111.json', '3112.json', '3113.json', '3115.json', '3116.json', '3117.json', '3118.json', '312.json', '3120.json', '3121.json', '3122.json', '3123.json', '3124.json', '3125.json', '3126.json', '3127.json', '3128.json', '3129.json', '313.json', '3131.json', '3132.json', '3133.json', '3134.json', '3135.json', '3136.json', '3137.json', '3138.json', '3139.json', '314.json', '3140.json', '3141.json', '3142.json', '3143.json', '3144.json', '3145.json', '3146.json', '3147.json', '3148.json', '3149.json', '315.json', '3150.json', '3151.json', '3152.json', '3153.json', '3154.json', '3155.json', '3156.json', '3157.json', '3158.json', '3159.json', '316.json', '3160.json', '3161.json', '3162.json', '3163.json', '3164.json', '3165.json', '3166.json', '3167.json', '3168.json', '3169.json', '317.json', '3170.json', '3171.json', '3172.json', '3173.json', '3174.json', '3175.json', '3176.json', '3177.json', '3178.json', '3179.json', '318.json', '3180.json', '3181.json', '3182.json', '3183.json', '3184.json', '3185.json', '3186.json', '3187.json', '3188.json', '3189.json', '319.json', '3190.json', '3191.json', '3192.json', '3193.json', '3194.json', '3195.json', '3196.json', '3197.json', '3198.json', '3199.json', '3200.json', '3201.json', '3202.json', '3203.json', '3204.json', '3205.json', '3206.json', '3207.json', '3208.json', '3209.json', '321.json', '3210.json', '3211.json', '3212.json', '3213.json', '3214.json', '3215.json', '3216.json', '3217.json', '3218.json', '3219.json', '322.json', '3220.json', '3221.json', '3222.json', '3223.json', '3224.json', '3225.json', '3226.json', '3227.json', '3228.json', '3229.json', '323.json', '3230.json', '3232.json', '3233.json', '3234.json', '3235.json', '3236.json', '3238.json', '3239.json', '324.json', '3240.json', '3241.json', '3242.json', '3243.json', '3244.json', '3245.json', '3246.json', '3247.json', '3248.json', '3249.json', '325.json', '3250.json', '3251.json', '3252.json', '3253.json', '3254.json', '3255.json', '3256.json', '3257.json', '3258.json', '3259.json', '326.json', '3260.json', '3261.json', '3262.json', '3263.json', '3264.json', '3265.json', '3266.json', '3267.json', '3268.json', '3269.json', '327.json', '3270.json', '3271.json', '3272.json', '3273.json', '3274.json', '3275.json', '3277.json', '3278.json', '3279.json', '328.json', '3280.json', '3281.json', '3282.json', '3283.json', '3284.json', '3285.json', '3286.json', '3287.json', '3288.json', '3289.json', '329.json', '3290.json', '3291.json', '3292.json', '3293.json', '3294.json', '3295.json', '3296.json', '3297.json', '3298.json', '3299.json', '33.json', '330.json', '3300.json', '3301.json', '3302.json', '3303.json', '3304.json', '3305.json', '3306.json', '3307.json', '3308.json', '3309.json', '331.json', '3310.json', '3311.json', '3312.json', '3313.json', '3314.json', '3315.json', '3317.json', '3318.json', '3319.json', '332.json', '3320.json', '3323.json', '3324.json', '3325.json', '3326.json', '3327.json', '3328.json', '3329.json', '333.json', '3330.json', '3331.json', '3332.json', '3333.json', '3334.json', '3335.json', '3336.json', '3337.json', '3338.json', '3339.json', '334.json', '3340.json', '3341.json', '3342.json', '3343.json', '3344.json', '3345.json', '3346.json', '3347.json', '3348.json', '3349.json', '3350.json', '3351.json', '3352.json', '3353.json', '3354.json', '3355.json', '3356.json', '3357.json', '3358.json', '336.json', '3360.json', '3361.json', '3362.json', '3363.json', '3364.json', '3365.json', '3366.json', '3367.json', '3368.json', '3369.json', '337.json', '3370.json', '3372.json', '3373.json', '3374.json', '3375.json', '3376.json', '3377.json', '3378.json', '3379.json', '3380.json', '3381.json', '3382.json', '3383.json', '3384.json', '3385.json', '3386.json', '3387.json', '3388.json', '3389.json', '3390.json', '3391.json', '3392.json', '3393.json', '3394.json', '3395.json', '3396.json', '3398.json', '3399.json', '34.json', '3400.json', '3401.json', '3402.json', '3403.json', '3404.json', '3405.json', '3406.json', '3407.json', '3408.json', '3409.json', '341.json', '3410.json', '3411.json', '3412.json', '3413.json', '3414.json', '3415.json', '3416.json', '3417.json', '3418.json', '3419.json', '342.json', '3420.json', '3421.json', '3422.json', '3423.json', '3424.json', '3425.json', '3426.json', '3427.json', '3429.json', '343.json', '3430.json', '3431.json', '3432.json', '3433.json', '3434.json', '3435.json', '3436.json', '3437.json', '3438.json', '3439.json', '344.json', '3440.json', '3441.json', '3442.json', '3443.json', '3444.json', '3445.json', '3446.json', '3448.json', '3449.json', '345.json', '3450.json', '3451.json', '3452.json', '3453.json', '3454.json', '3455.json', '3456.json', '3457.json', '3458.json', '346.json', '3460.json', '3461.json', '3462.json', '3463.json', '3464.json', '3465.json', '3466.json', '3467.json', '3468.json', '3469.json', '347.json', '3470.json', '3471.json', '3472.json', '3473.json', '3474.json', '3475.json', '3476.json', '3477.json', '3478.json', '348.json', '3480.json', '3481.json', '3482.json', '3484.json', '3485.json', '3486.json', '3487.json', '3488.json', '3489.json', '3490.json', '3491.json', '3492.json', '3493.json', '3494.json', '3495.json', '3496.json', '3498.json', '3499.json', '35.json', '350.json', '3500.json', '3501.json', '3503.json', '3504.json', '3505.json', '3506.json', '3507.json', '3508.json', '3509.json', '351.json', '3510.json', '3511.json', '3512.json', '3513.json', '3514.json', '3515.json', '3516.json', '3517.json', '3518.json', '3519.json', '352.json', '3520.json', '3521.json', '3522.json', '3523.json', '3524.json', '3525.json', '3526.json', '3527.json', '3528.json', '3529.json', '353.json', '3530.json', '3531.json', '3532.json', '3533.json', '3534.json', '3535.json', '3536.json', '3537.json', '3538.json', '3539.json', '354.json', '3540.json', '3541.json', '3542.json', '3543.json', '3544.json', '3545.json', '3546.json', '3547.json', '3548.json', '3549.json', '355.json', '3550.json', '3551.json', '3552.json', '3553.json', '3554.json', '3555.json', '3556.json', '3557.json', '3558.json', '3559.json', '356.json', '3560.json', '3561.json', '3562.json', '3563.json', '3564.json', '3565.json', '3566.json', '3567.json', '3568.json', '3569.json', '357.json', '3570.json', '3571.json', '3572.json', '3573.json', '3574.json', '3575.json', '3576.json', '3577.json', '3578.json', '3579.json', '358.json', '3580.json', '3581.json', '3582.json', '3583.json', '3584.json', '3585.json', '3586.json', '3587.json', '3588.json', '3589.json', '359.json', '3590.json', '3591.json', '3592.json', '3593.json', '3594.json', '3595.json', '3596.json', '3597.json', '3598.json', '3599.json', '36.json', '360.json', '3600.json', '3601.json', '3602.json', '3603.json', '3604.json', '3605.json', '3606.json', '3607.json', '3608.json', '3609.json', '361.json', '3610.json', '3611.json', '3612.json']

#with open('driver_nums.csv', 'r') as dn:
#    reader = csv.reader(dn, delimiter=',')
#    for r in reader:
#        all_drivers.append(str(r[0]) + ".json")

K = 200


def maketups(x):
    left = (x[0], x[1])
    right = (x[2], x[3], x[4], x[5])
    return left, right


def labelRDDs(driver, path, sc):
    sqlContext = SQLContext(sc)

    target = str(driver) + '.json'
    driver_pool = list(all_drivers)
    driver_pool.remove(target)

    sample_drivers = np.random.choice(driver_pool, K, replace=False)
    sample_drivers_paths = [path + i for i in sample_drivers]
    sampled = sqlContext.read.json(sample_drivers_paths)
    orig = sqlContext.read.json(path + target)
    samples = sampled.sample(False, .0055)
    samples = samples.withColumn('label', lit(0))
    orig = orig.withColumn('label', lit(1))
    rawdata = samples.unionAll(orig)
    rawdata = rawdata.select(rawdata['driver'],
                             rawdata['trip'],
                             rawdata['x'],
                             rawdata['y'],
                             rawdata['step'],
                             rawdata['label'])
    rawRDD = rawdata.rdd
    return rawRDD.map(maketups)
